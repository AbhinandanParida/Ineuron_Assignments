hadoop jar /usr/hdp/current/hadoop-mapreduce-client/hadoop-streaming.jar \
  -D map.output.key.field.separator='\t' \
  -D mapreduce.partition.keypartitioner.options=-k1 \
  -D mapreduce.job.reduces=2 \
  -input /user/root/temp.txt \
  -output /user/root/maxtempoutput \
  -mapper mapper.py \
  -reducer reducer.py \
  -file /root/tempcode/mapper.py \
  -file /root/tempcode/reducer.py
  -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner